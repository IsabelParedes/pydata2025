<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/astro.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Merriweather+Sans&display=swap" rel="stylesheet">
    <title>QuantStack</title>
    <style>
    </style>
  </head>
  <body>
    <script type="module" src="/src/main.ts"></script>
    <div class="reveal">
		<div class="slides">

        <section data-background="./abstract_main.jpg">
          <h1 class="main-title">Expanding Programming Language Support in JupyterLite</h1>
          <img src="/src/images/logo_scientific_computing.svg" alt="QuantStack Logo" class="title-logo">
        </section>

        <section data-markdown>
          <textarea data-template>
            ## Introduction
            Who is this??
          </textarea>
        </section>

        <section class="cosmo-slide">
          <img src="/src/images/cosmo_pkg.png" alt="QuantStack Logo" class="cosmo-img">
          <h2 class="main-title">Introduction to Emscripten-Forge</h1>
        </section>

        <section class="cosmo-slide">
          <img src="/src/images/cosmo_victory.png" alt="QuantStack Logo" class="cosmo-img">
          <h2 class="main-title">Xeus Kernels in JupyterLite</h1>
        </section>

        <section data-markdown>
          <textarea data-template>
            ## Slide 1
            A paragraph with some text
            ---
            ## Slide 2
            ---
            ## Slide 3
          </textarea>
        </section>


        <section class="cosmo-slide">
          <img src="/src/images/cosmo_rock.png" alt="QuantStack Logo" class="cosmo-img">
          <h2 class="main-title">Packaging R for WebAssembly</h1>
        </section>

        <section>
          <h2>WebR</h2>
          <div class="two-column">
            <div class="column">
              <ul>
                <li>Emscripten</li>
                <li>Fortran compiler</li>
                <ul>
                  <li>Custom development version of <strong>LLVM Flang</strong></li>
                  <li><code>gfortran</code> and Dragonegg</li>
                </ul>
              </ul>
            </div>
            <div class="column">
                <img src="/src/images/webr.png"
                  alt="webr logo - purple webassembly square with R-wa">
                <img src="/src/images/rwasm.png"
                  alt="rwasm logo - truck with packages">
            </div>
          </div>
        </section>

        <section>
          <h2>Core Dependencies of R</h2>
          <div class="two-column">
            <div class="column-top-align">
              <img src="/src/images/c_logo.svg" alt="C language logo" style="height: 4em;">
              <ul>
                <li style="margin: 0;">Required</li>
                <ul>
                  <li><code>libiconv</code></li>
                  <li><code>zlib</code></li>
                  <li><code>bzip2</code></li>
                  <li><code>lzma</code></li>
                  <li><code>pcre2</code></li>
                </ul>
                <li style="margin: 0;">Optional</li>
                <ul>
                  <li><code>libpng</code></li>
                  <li><code>cairo</code></li>
                  <li><code>libtiff</code></li>
                  <li><code>glib</code></li>
                </ul>
              </ul>
            </div>
            <div class="column-top-align">
              <img src="/src/images/fortran_logo.svg" alt="Fortran language logo" style="height: 4em;">
              <ul>
                <li style="margin: 2em 0 0">Required</li>
                <ul>
                  <li>BLAS / LAPACK</li>
                </ul>
                <li style="margin: 1em 0 0;">R packages</li>
                <ul>
                  <li><code>nlme</code></li>
                </ul>
              </ul>
            </div>
          </div>
        </section>

        <section>
          <h2>Fortran to WebAssembly</h2>
          <div class="two-column">
            <div class="column">
              <h3>LLVM Flang</h3>
              <ul>
                <li>Modern LLVM Integration</li>
                <li>Active Development</li>
                <li>WebAssembly Target Support</li>
              </ul>
            </div>
            <div class="column">
              <img src="/src/images/llvm_wyvern.png" alt="LLVM logo of wyvern dragon">
            </div>
          </div>
        </section>

        <section>
          <h2>LLVM Flang</h2>
          <div class="two-column">
            <div class="column">
              <video src="/src/videos/digits.webm" autoplay loop muted playsinline style="max-width: 90%; margin-top: 1rem; box-shadow: 0 0 10px rgba(0, 0, 0, 0.35);"></video>
              <p><a href="https://gws.phd/posts/fortran_wasm/"><strong>Fortran on WebAssembly</strong>: Patching LLVM Flang to output WebAssembly objects</a></p>
              <p>by George Stagg</p>
            </div>
            <div class="column">
              <h3>Serge Guelton</h3>
              <ul>
                <li style="margin: 0;">Upstreamed contributions:</li>
                <ul>
                  <li><a href="https://github.com/llvm/llvm-project/pull/99465">Fix implicit conversion warning when targeting 32bit systems</a></li>
                  <li><a href="https://github.com/llvm/llvm-project/pull/99822">Explicitly convert shift value to SubscriptValue</a></li>
                  <li><a href="https://github.com/llvm/llvm-project/pull/101242">Handle missing definitions in cfenv</a></li>
                  <li><a href="https://github.com/llvm/llvm-project/pull/105589">Fix type used to store result of typeInfo::Value::GetValue</a></li>
                </ul>
                <li style="margin: 0;">Additional patches:</li>
                <ul>
                  <li><a href="https://github.com/conda-forge/flang-feedstock/blob/emscripten/recipe/patches/0002-Minimal-WASM-support-for-flang.patch">Minimal WASM support for Flang</a></li>
                  <li><a href="https://github.com/conda-forge/flang-feedstock/blob/emscripten/recipe/patches/0003-Specialize-Flang-to-target-WASM.patch">Specialize Flang to target WASM</a></li>
                  <li><a href="https://github.com/conda-forge/flang-feedstock/blob/emscripten/recipe/patches/0004-Disable-float128-math.patch">Disable <code>float128</code> math</a></li>
                </ul>
              </ul>
            </div>
          </div>
        </section>

        <section>
          <h2>LLVM Flang in Action</h2>
            <pre><code data-trim data-noescape>
            micromamba install conda-forge/label/emscripten::flang libllvm20 --no-channel-priority
            </code></pre>
        </section>

        <section class="cosmo-slide">
          <img src="/src/images/cosmo_pkg_walk.png" alt="QuantStack Logo" class="cosmo-img">
          <h2 class="main-title">Packaging GNU Octave for WebAssembly</h1>
        </section>

        <section class="cosmo-slide">
          <img src="/src/images/cosmo_fly.png" alt="QuantStack Logo" class="cosmo-img">
          <h2 class="main-title">JupyterLite Terminal</h1>
        </section>

        <section>
          <h2>Terminal</h2>
          <div style="margin: 1em;">
          <h3>In JupyterLab</h3>
            <ul>
              <li>Terminal connects to a real shell running on the server</li>
            </ul>
          </div>
          <div style="margin: 1em;">
          <h3>In JupyterLite</h3>
            <ul>
              <li>Terminal connects to a shell emulator running in the browser</li>
              <li>Mixture of TypeScript and WebAssembly</li>
              <li>Two projects
                <ul>
                  <li><a href="https://github.com/jupyterlite/cockle">cockle</a>: standalone shell without any JupyterLite dependencies</li>
                  <li><a href="https://github.com/jupyterlite/terminal">terminal</a>: JupyterLite extension using cockle</li>
                </ul>
              </li>
            </ul>
          </div>
        </section>

        <section>
          <h2>Demo of JupyterLite Terminal</h2>
          <h3><a href="https://jupyterlite.github.io/terminal">https://jupyterlite.github.io/terminal</a></h3>
          <ul>
            <li>Access the shared JupyterLite file system</li>
            <li>List commands available</li>
            <li>Editors <code>vim</code> and <code>nano</code></li>
            <li><code>uname -a</code> shows it is an emscripten build</li>
            <li><code>cockle-config package</code> shows installed emscripten-forge packages</li>
          </ul>
        </section>

        <section>
          <h2>Emscripten Forge packages for Terminal</h2>
          <ul>
            <li><code>coreutils</code>, <code>grep</code>, <code>less</code>, <code>nano</code>, <code>sed</code>, <code>vim</code></li>
            <li>Example recipe <a href="https://github.com/emscripten-forge/recipes/tree/main/recipes/recipes_emscripten/vim">vim</a></li>
            <ul>
              <li><code>recipe.yaml</code></li>
              <ul>
                <li><code>source url</code> shows source from official vim repo</li>
                <li>Small patch</li>
                <li>Depends on <code>ncurses</code></li>
              </ul>
              <li>Build script <code>build.sh</code></li>
              <ul>
                <li>C source code</li>
                <li>Familiar <code>configure</code> and <code>make</code> build steps</li>
                <li>Outputs <code>vim.js</code>, <code>vim.wasm</code> and <code>vim.data</code></li>
              </ul>
            </ul>
          </ul>
        </section>

        <section>
          <h2>Looking ahead: git</h3>
          <ul>
            <li><a href="https://github.com/QuantStack/git2cpp">git2cpp</a> (C++) wraps <a href="https://github.com/libgit2/libgit2">libgit2</a> (C) to provide command-line tools</li>
            <li>Emscripten Forge builds patched to communicate with remote hosts</li>
            <li>Basic functionality (clone, add, commit) almost ready...</li>
            <li>Incremental addition of new functionality</li>
          </ul>
        </section>

        <section class="cosmo-slide">
          <img src="/src/images/cosmo_rocket.png" alt="QuantStack Logo" class="cosmo-img">
          <h2 class="main-title">Thank You!</h1>
        </section>

        <section data-markdown>
          <textarea data-template>
            ## Resources
            A paragraph with some text
          </textarea>
        </section>

      </div>
		</div>
  </body>
</html>
